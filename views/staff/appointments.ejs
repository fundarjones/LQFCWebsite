<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

	<link href="assets/images/favicon/favicon.png" rel="icon">
	<link rel="stylesheet" href="../css/appointments-style.css">
	
	<link href="../js/vendor/select2/select2.min.css" rel="stylesheet" media="all">
	
	<link href="../js/vendor/mdi-font/css/material-design-iconic-font.min.css" rel="stylesheet" media="all">
	<link href="../js/vendor/font-awesome-4.7/css/font-awesome.min.css" rel="stylesheet" media="all">


	<% if (staff) { %>
		<title><%= staff.first_name %> <%= staff.last_name %> | Lagman Qualicare Family Clinic</title>
</head>
<body>
	
	<!-- SIDEBAR -->
	<section id="sidebar">
		
		<a href="/dashboard" class="brand"><img class='logo' src="../../assets/images/logo/logo.png"></a>
		<ul class="side-menu">
			<li><a href="/dashboard"><i class='bx bxs-dashboard icon' ></i> Dashboard</a></li>
			<li class="divider" data-text="main">Main</li>
			
			<li><a href="/appointments" class="active"><i class='bx bxs-book-heart icon' ></i> Appointments</a></li>
			<li><a href="/patients"><i class='bx bxs-user icon' ></i> Patients</a></li>
		</ul>
	</section>
	<!-- SIDEBAR -->

	<!-- NAVBAR -->
	<section id="content">
		<!-- NAVBAR -->
		<nav>
			<i class='bx bx-menu toggle-sidebar'></i>
			<form action="#">
			</form>
			<span class="divider"></span>
			<div class="profile">
				
				<% if(!staff.img.contentType){ %>
					<img src="files/male-avatar.png" alt="User Img">
				<% } else { %>
					<img src="data:image/<%=staff.img.contentType%>;base64,<%=staff.img.data.toString(base)%>" alt="User Img">
				<% } %>
				<ul class="profile-link">
					<form action="/profile" method="GET">
						<li><button type="submit"><i class='bx bxs-user-circle icon' ></i> Profile</button></li>
					</form>
					<form action="/settings" method="GET">
						<li><button type="submit"><i class='bx bxs-cog' ></i> Settings</button></li>
					</form>
					<form action="/logout?_method=DELETE" method="POST">
						<li><button type="submit"><i class='bx bxs-log-out-circle' ></i> Logout</button></li>
					</form>
				</ul>
			</div>
		</nav>
		<!-- NAVBAR -->

		<!-- MAIN -->
		<main>
			<% if(typeof alert != 'undefined') { %>
			  <div class="alert"> <%= alert %>
				<span class="closebtn" onclick="this.parentElement.style.display='none';">&times;
			</span>
			  </div>

			<% } %>
			<section class="ftco-section">
				<div class="container">
			<h1 class="title">Appointments</h1>
					<div class="row">
						<div class="col-sm-12 col-md-12">
							<form action="#">
							<div class="form-group">
								<input type="text" id="search" placeholder="Search...">
							</div>
							</form>
						</div>
						<div class="col-sm-12 col-md-12">
							<p><input type="checkbox" class="mt-3 ml-2 custom-checkbox" id="showTodayOnly" onclick="showToday()">
								Show today's appointments only</p>
						</div>
					</div>
					</div>
					
					<section class="ftco-section">
						<div class="container">
		
							<div class="tabs">
		  
								<input type="radio" id="tab1" name="tab-control" checked>
								<input type="radio" id="tab2" name="tab-control">
								<hr>
								<ul>
								  <li title="normal"><label for="tab1" role="button"><span>Patients Who Don't Have Infectious Symptoms</span></label></li>
								  <li title="positive"><label for="tab2" role="button"><span>Patients Who Has Infectious Symptoms</span></label></li>
									
								</ul>
								<hr>
				
								<div class="content">
				
									<!-- NOT POSITIVE SECTION-->
									<section>

										<h5 class="text-muted mb-3">Approved Appointments</h5>	
										<div class="row justify-content-center" id="appointment-confirmed-not"></div>
										<hr>
										<h5 class="text-muted mb-3">Pending Appointments</h5>	
										<div class="row justify-content-center" id="appointment-pending-not"></div>
										<hr>
										<h5 class="text-muted mb-3">Cancelled Appointments</h5>	
										<div class="row justify-content-center" id="appointment-cancelled-not"></div>
										<hr>
										<h5 class="text-muted mb-3">Completed Appointments</h5>	
										<div class="row justify-content-center" id="appointment-done-not"></div>

										<div class="row">
											<% appointment.reverse().forEach(function(appointments){ %>
											<% if( appointments.pre_diagnose_result == "Patient Has Non Infectious Symptoms" && appointments.appointment_status != "Approved" && staff.branch == appointments.branch && !appointments.approved_staff) { %> 
												<div class="searchhide not">
													<div class="card p-3 mb-4">
														<div class="d-flex justify-content-between mb-4">
															<div class="user-info">
																<div class="user-info__img">
																	<img src="uploads/<%= appointments.img_id %>.png" alt="User Img" onerror="this.onerror=null;this.src='files/male-avatar.png';">
																</div>
																<div class="user-info__basic">
																	<h6 class="mb-0"><%= appointments.img_id %></h6>
																	<h5 class="text-highlight mb-0"><%= appointments.first_name %> <%= appointments.last_name %></h5>
																	<p class="text-muted mb-0" id="age<%= appointments._id %>"></p>
																</div>
															</div>
																	
															<% if (appointments.appointment_status != "Cancelled") {%> 
																<div class="dropdown open">
																	<a href="#!" class="px-2" id="b<%= appointments.id %>" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
																		<i class="fa fa-ellipsis-v"></i>
																	</a>
																	<div class="dropdown-menu dropdown-menu-right" aria-labelledby="<%= appointments.id %>">
														
																		<input type="button" class="dropdown-item text-primary" id="triggerId1"
																		data-toggle="modal" data-target="#a<%= appointments._id %><%= appointments.appointment_status %>" aria-haspopup="true"
																		aria-expanded="false" value="Set Appointment" onclick="editTimeDate()">
	
																		<form action="/cancel-appointment?_method=PUT" method="POST">
																			<input type="text" name="_id" value="<%= appointments._id %>" hidden>
																			<input class="dropdown-item text-danger" type="submit" value="Cancel">
																		</form>
																	</div>
																</div>
																<% } else { %> 
																	<div class="dropdown open">
																		<a href="#!" class="px-2" id="<%= appointments.id %>" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
																			<i class="fa fa-ellipsis-v"></i>
																		</a>
																		<div class="dropdown-menu dropdown-menu-right" aria-labelledby="<%= appointments.id %>">
																			<form action="/deactivate" method="POST">
																				<input type="text" name="_id" value="<%= appointments._id %>" hidden>
																				<input type="submit" class="dropdown-item text-danger" value="Remove">
																			</form>
																		</div>
																	</div>
															<% } %> 
														</div>
	
														<div class="btn-records">
															<a class="button record-button" href="#!" id="triggerId1" data-toggle="modal"
															data-target="#a<%= appointments._id %><%= appointments.appointment_status %>"
															aria-haspopup="true" aria-expanded="false">View Appointment Info</a>
														</div>
														<hr>
														<div class="d-flex justify-content-between">
															<% if(appointments.appointment_status == "Cancelled") {%>
																<span class="text-warning font-weight-bold mt-3"><%= appointments.appointment_status %></span>
																<div>
																	<h5 class="mb-0"><%= appointments.time %>
																	</h5>
																	<medium class="mt-0"><%= appointments.date %></medium>
																</div>
															<% }  else { %> 
																<span class="text-primary font-weight-bold"><%= appointments.appointment_status %></span>
															<% } %> 
														</div>
													</div>
												</div>
					
										<!-- ============================
												APPOINTMENT VIEW CARD
										============================== -->
					
										<div class="modal fade" id="a<%= appointments._id %><%= appointments.appointment_status %>" tabindex="-1" role="dialog">
											<div class="modal-dialog modal-dialog-centered" role="document">
											<div class="modal-content">
												<form action="/approve-appointment?_method=PUT" method="POST">
												<div class="p-4">
													<div class="d-flex justify-content-between mb-4">
														<div class="user-info">
															<div class="user-info__img">
																	<img src="uploads/<%= appointments.img_id %>.png" alt="User Img" onerror="this.onerror=null;this.src='files/male-avatar.png';">
															</div>
															<div class="user-info__basic">
																<h6 class="mb-0"><%= appointments.img_id %></h6>
																<h5 class="text-highlight mb-0"><%= appointments.first_name %> <%= appointments.last_name %></h5>
																<p class="text-muted mb-0" id="age<%= appointments._id %>"></p>
															</div>
														</div>
														<% if (appointments.appointment_status != "Cancelled") {%> 
															<div class="dropdown open dropdown-set ">
																<a href="#!" class="px-2" id="b<%= appointments.id %>" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
																	<i class="fa fa-ellipsis-v"></i>
																</a>
																<div class="dropdown-menu dropdown-menu-right" aria-labelledby="<%= appointments.id %>">

																	<input type="button" class="dropdown-item text-primary"
																	data-target="#a<%= appointments._id %><%= appointments.appointment_status %>"
																	value="Set Appointment" onclick="editTimeDate()">

																	<form action="/cancel-appointment?_method=PUT" method="POST">
																		<input type="text" name="_id" value="<%= appointments._id %>" hidden>
																		<input class="dropdown-item text-danger" type="submit" value="Cancel Appointment">
																	</form>
																</div>
															</div>
															<% } else { %> 
																<div class="dropdown open">
																	<a href="#!" class="px-2" id="<%= appointments.id %>" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
																		<i class="fa fa-ellipsis-v"></i>
																	</a>
																	<div class="dropdown-menu dropdown-menu-right" aria-labelledby="<%= appointments.id %>">
																		<form action="/deactivate" method="POST">
																			<input type="text" name="_id" value="<%= appointments._id %>" hidden>
																			<input type="submit" class="dropdown-item text-danger" value="Remove">
																		</form>
																	</div>
																</div>
														<% } %> 
													</div>

														<p class="font-weight-bold text-info center"><%= appointments.service %></p>
														<hr>
														<div class="row">
															<div class="col-md-6 col-xs-6 col-sm-6">
																	<center>
																	<p class="text-muted mb-0 mt-2">Primary Phone</p>
																	<h5 id="first_num"><%= appointments.phone %></h5>
																	</center>
															</div>
															<div class="col-md-6 col-xs-6 col-sm-6">
																	<center>
																	<p class="text-muted mb-0 mt-2">Secondary Phone</p>
																	<h5 id="second_num<%= appointments._id %>"><%= appointments.phone2 %></h5>
																	</center>
																	<script>
																		var second_num = document.getElementById("second_num<%= appointments._id %>").textContent;
																		if (second_num.length === 0 ) {
																		document.getElementById("second_num<%= appointments._id %>").innerHTML = "None";
																		}
																	</script>
															</div>
														</div>
														<hr>
														<div class="row mb-4 mt-4">
														<div class="col-md-6 col-xs-6 col-sm-6">
																<center>
																<p class="text-muted mb-0">Date</p>
																<input class="input--style-4 mb-3" value="" name="date" id="date-no-past" type="date" required>
																</center>
														</div>
														<div class="col-md-6 col-xs-6 col-sm-6">
																<center>
																<p class="text-muted mb-0">Time</p>
																<input class="input--style-4 mb-3" name="time" id="date-no-past" type="time" required>
																</center>
														</div>
														</div>
														<hr>
														<div class="d-flex justify-content-between mt-3">
														<% if(appointments.appointment_status == "Cancelled") {%> 
															<h6 class= "mt-3">Status: 
															<span class="text-warning font-weight-bold"><%= appointments.appointment_status %></span>
															</h6>
															<div>
																<h5 class="mb-0"><%= appointments.time %>
																</h5>
																<medium class="mb-0"><%= appointments.date %></medium>
															</div>
														<% }  else { %> 
															<h6 class= "mt-2">Status: 
															<span class="text-primary font-weight-bold"><%= appointments.appointment_status %></span>
															</h6>
															
															<input type="text" name="_id" value="<%= appointments._id %>" hidden>
															<input type="submit" class="button confirm-button" href="#!" id="confirm-date-time" aria-expanded="false" style="display: none ;" value="Approve Appointment">
														<% } %> 
														</div>
													</div>
													</form>
												</div>
											</div>
										</div>
										<% } else if( appointments.pre_diagnose_result == "Patient Has Non Infectious Symptoms" && appointments.appointment_status == "Approved" && staff.branch == appointments.branch) { %> 
											<div class="searchhide not">
												<div class="card p-3 mb-4">
													<div class="d-flex justify-content-between mb-4">
														<div class="user-info">
															<div class="user-info__img">
																<img src="uploads/<%= appointments.img_id %>.png" alt="User Img" onerror="this.onerror=null;this.src='files/male-avatar.png';">
															</div>
															<div class="user-info__basic">
																<h6 class="mb-0"><%= appointments.img_id %></h6>
																<h5 class="text-highlight mb-0"><%= appointments.first_name %> <%= appointments.last_name %></h5>
																<p class="text-muted mb-0" id="age<%= appointments._id %>"></p>
															</div>
														</div>
													</div>

													<div class="btn-records">
														<a class="button record-button" href="#!" id="triggerId1" data-toggle="modal"
														data-target="#a<%= appointments._id %><%= appointments.appointment_status %>"
														aria-haspopup="true" aria-expanded="false">View Appointment Info</a>
													</div>
													<hr>
													<div class="d-flex justify-content-between">
														<% if(appointments.appointment_status == "Cancelled") {%>
															<span class="text-warning font-weight-bold mt-3"><%= appointments.appointment_status %></span>
															<div>
																<h5 class="mb-0"><%= appointments.time %>
																</h5>
																<medium class="mt-0"><%= appointments.date %></medium>
															</div>
														<% }  else { %> 
															<span class="text-primary font-weight-bold"><%= appointments.appointment_status %></span>
															<medium class="mt-0"><%= appointments.date %> <br> <%= appointments.time %></medium>
														<% } %> 
													</div>
												</div>
											</div>
				
									<!-- ============================
											APPOINTMENT VIEW CARD
									============================== -->
				
									<div class="modal fade" id="a<%= appointments._id %><%= appointments.appointment_status %>" tabindex="-1" role="dialog">
										<div class="modal-dialog modal-dialog-centered" role="document">
										<div class="modal-content">
											<form action="/approve-appointment?_method=PUT" method="POST">
											<div class="p-4">
												<div class="d-flex justify-content-between mb-4">
													<div class="user-info">
														<div class="user-info__img">
																<img src="uploads/<%= appointments.img_id %>.png" alt="User Img" onerror="this.onerror=null;this.src='files/male-avatar.png';">
														</div>
														<div class="user-info__basic">
															<h6 class="mb-0"><%= appointments.img_id %></h6>
															<h5 class="text-highlight mb-0"><%= appointments.first_name %> <%= appointments.last_name %></h5>
															<p class="text-muted mb-0" id="age<%= appointments._id %>"></p>
														</div>
													</div>
												</div>

													<p class="font-weight-bold text-info center"><%= appointments.service %></p>
													<hr>
													<div class="row">
														<div class="col-md-6 col-xs-6 col-sm-6">
																<center>
																<p class="text-muted mb-0 mt-2">Primary Phone</p>
																<h5 id="first_num"><%= appointments.phone %></h5>
																</center>
														</div>
														<div class="col-md-6 col-xs-6 col-sm-6">
																<center>
																<p class="text-muted mb-0 mt-2">Secondary Phone</p>
																<h5 id="second_num<%= appointments._id %>"><%= appointments.phone2 %></h5>
																</center>
																<script>
																	var second_num = document.getElementById("second_num<%= appointments._id %>").textContent;
																	if (second_num.length === 0 ) {
																	document.getElementById("second_num<%= appointments._id %>").innerHTML = "None";
																	}
																</script>
														</div>
													</div>
													<hr>
													<div class="row mb-4 mt-4">
													<div class="col-md-6 col-xs-6 col-sm-6">
														<center>
															<p class="text-muted mb-0 mt-2">Date</p>
															<h5><%= appointments.date %></h5>
															</center>
													</div>
													<div class="col-md-6 col-xs-6 col-sm-6">
														<center>
															<p class="text-muted mb-0 mt-2">Time</p>
															<h5><%= appointments.time %></h5>
															</center>
													</div>
													</div>
													<hr>
													<div class="d-flex justify-content-between mt-3">
													<% if(appointments.appointment_status == "Cancelled") {%> 
														<h6 class= "mt-3">Status: 
														<span class="text-warning font-weight-bold"><%= appointments.appointment_status %></span>
														</h6>
														<div>
															<h5 class="mb-0"><%= appointments.time %>
															</h5>
															<medium class="mb-0"><%= appointments.date %></medium>
														</div>
													<% }  else { %> 
														<h6 class= "mt-2">Status: 
														<span class="text-primary font-weight-bold"><%= appointments.appointment_status %></span>
														</h6>
														
														<input type="text" name="_id" value="<%= appointments._id %>" hidden>
														<input type="submit" class="button confirm-button" href="#!" id="confirm-date-time" aria-expanded="false" style="display: none ;" value="Approve Appointment">
													<% } %> 
													</div>
												</div>
												</form>
											</div>
										</div>
									</div>
										<% } %> 
										<script>
											var now = Date.now();
											var bday = new Date("<%= appointments.birthday%>");
											var minus = now-bday
											var age = Math.floor(minus / 1000 / 60 / 60 / 24 / 365);
											document.getElementById("age<%= appointments._id %>").innerText = age + " yrs | <%= appointments.sex %>"
										</script>
										<% }); %> 
											
										</div>


									</section>

									<!-- POSITIVE SECTION-->
									<section>

										<h5 class="text-muted mb-3">Approved Appointments</h5>	
										<div class="row justify-content-center" id="appointment-confirmed-yes"></div>
										<hr>
										<h5 class="text-muted mb-3">Pending Appointments</h5>	
										<div class="row justify-content-center" id="appointment-pending-yes"></div>
										<hr>
										<h5 class="text-muted mb-3">Cancelled Appointments</h5>	
										<div class="row justify-content-center" id="appointment-cancelled-yes"></div>
										<hr>
										<h5 class="text-muted mb-3">Completed Appointments</h5>	
										<div class="row justify-content-center" id="appointment-done-yes"></div>

										<div class="row">
											<% appointment.reverse().forEach(function(appointments){ %>
											<% if( appointments.pre_diagnose_result == "Patient Has Infectious Symptoms" && appointments.appointment_status != "Approved" && staff.branch == appointments.branch && !appointments.approved_staff) { %> 
												<div class="searchhide yes">
													<div class="card p-3 mb-4">
														<div class="d-flex justify-content-between mb-4">
															<div class="user-info">
																<div class="user-info__img">
																	<img src="uploads/<%= appointments.img_id %>.png" alt="User Img" onerror="this.onerror=null;this.src='files/male-avatar.png';">
																</div>
																<div class="user-info__basic">
																	<h6 class="mb-0"><%= appointments.img_id %></h6>
																	<h5 class="text-highlight mb-0"><%= appointments.first_name %> <%= appointments.last_name %></h5>
																	<p class="text-muted mb-0" id="age<%= appointments._id %>"></p>
																</div>
															</div>
																	
															<% if (appointments.appointment_status != "Cancelled") {%> 
																<div class="dropdown open">
																	<a href="#!" class="px-2" id="b<%= appointments.id %>" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
																		<i class="fa fa-ellipsis-v"></i>
																	</a>
																	<div class="dropdown-menu dropdown-menu-right" aria-labelledby="<%= appointments.id %>">
														
																		<input type="button" class="dropdown-item text-primary" id="triggerId1"
																		data-toggle="modal" data-target="#a<%= appointments._id %><%= appointments.appointment_status %>" aria-haspopup="true"
																		aria-expanded="false" value="Set Appointment" onclick="editTimeDate()">

																		<form action="/cancel-appointment?_method=PUT" method="POST">
																			<input type="text" name="_id" value="<%= appointments._id %>" hidden>
																			<input class="dropdown-item text-danger" type="submit" value="Cancel">
																		</form>
																	</div>
																</div>
																<% } else { %> 
																	<div class="dropdown open">
																		<a href="#!" class="px-2" id="<%= appointments.id %>" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
																			<i class="fa fa-ellipsis-v"></i>
																		</a>
																		<div class="dropdown-menu dropdown-menu-right" aria-labelledby="<%= appointments.id %>">
																			<form action="/deactivate" method="POST">
																				<input type="text" name="_id" value="<%= appointments._id %>" hidden>
																				<input type="submit" class="dropdown-item text-danger" value="Remove">
																			</form>
																		</div>
																	</div>
															<% } %> 
														</div>
	
														<div class="btn-records">
															<a class="button record-button" href="#!" id="triggerId1" data-toggle="modal"
															data-target="#a<%= appointments._id %><%= appointments.appointment_status %>"
															aria-haspopup="true" aria-expanded="false">View Appointment Info</a>
														</div>
														<hr>
														<div class="d-flex justify-content-between">
															<% if(appointments.appointment_status == "Cancelled") {%>
																<span class="text-warning font-weight-bold mt-3"><%= appointments.appointment_status %></span>
																<div>
																	<h5 class="mb-0"><%= appointments.time %>
																	</h5>
																	<medium class="mt-0"><%= appointments.date %></medium>
																</div>
															<% }  else { %> 
																<span class="text-primary font-weight-bold"><%= appointments.appointment_status %></span>
															<% } %> 
														</div>
													</div>
												</div>
					
										<!-- ============================
												APPOINTMENT VIEW CARD
										============================== -->
					
										<div class="modal fade" id="a<%= appointments._id %><%= appointments.appointment_status %>" tabindex="-1" role="dialog">
											<div class="modal-dialog modal-dialog-centered" role="document">
											<div class="modal-content">
												<form action="/approve-appointment?_method=PUT" method="POST">
												<div class="p-4">
													<div class="d-flex justify-content-between mb-4">
														<div class="user-info">
															<div class="user-info__img">
																	<img src="uploads/<%= appointments.img_id %>.png" alt="User Img" onerror="this.onerror=null;this.src='files/male-avatar.png';">
															</div>
															<div class="user-info__basic">
																<h6 class="mb-0"><%= appointments.img_id %></h6>
																<h5 class="text-highlight mb-0"><%= appointments.first_name %> <%= appointments.last_name %></h5>
																<p class="text-muted mb-0" id="age<%= appointments._id %>"></p>
															</div>
														</div>
														<% if (appointments.appointment_status != "Cancelled") {%> 
															<div class="dropdown open dropdown-set ">
																<a href="#!" class="px-2" id="b<%= appointments.id %>" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
																	<i class="fa fa-ellipsis-v"></i>
																</a>
																<div class="dropdown-menu dropdown-menu-right" aria-labelledby="<%= appointments.id %>">

																	<input type="button" class="dropdown-item text-primary"
																	data-target="#a<%= appointments._id %><%= appointments.appointment_status %>"
																	value="Set Appointment" onclick="editTimeDate()">

																	<form action="/cancel-appointment?_method=PUT" method="POST">
																		<input type="text" name="_id" value="<%= appointments._id %>" hidden>
																		<input class="dropdown-item text-danger" type="submit" value="Cancel Appointment">
																	</form>
																</div>
															</div>
															<% } else { %> 
																<div class="dropdown open">
																	<a href="#!" class="px-2" id="<%= appointments.id %>" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
																		<i class="fa fa-ellipsis-v"></i>
																	</a>
																	<div class="dropdown-menu dropdown-menu-right" aria-labelledby="<%= appointments.id %>">
																		<form action="/deactivate" method="POST">
																			<input type="text" name="_id" value="<%= appointments._id %>" hidden>
																			<input type="submit" class="dropdown-item text-danger" value="Remove">
																		</form>
																	</div>
																</div>
														<% } %> 
													</div>

														<p class="font-weight-bold text-info center"><%= appointments.service %></p>
														<hr>
														<div class="row">
															<div class="col-md-6 col-xs-6 col-sm-6">
																	<center>
																	<p class="text-muted mb-0 mt-2">Primary Phone</p>
																	<h5 id="first_num"><%= appointments.phone %></h5>
																	</center>
															</div>
															<div class="col-md-6 col-xs-6 col-sm-6">
																	<center>
																	<p class="text-muted mb-0 mt-2">Secondary Phone</p>
																	<h5 id="second_num<%= appointments._id %>"><%= appointments.phone2 %></h5>
																	</center>
																	<script>
																		var second_num = document.getElementById("second_num<%= appointments._id %>").textContent;
																		if (second_num.length === 0 ) {
																		document.getElementById("second_num<%= appointments._id %>").innerHTML = "None";
																		}
																	</script>
															</div>
														</div>
														<hr>
														<div class="row mb-4 mt-4">
															<div class="col-md-6 col-xs-6 col-sm-6">
																<center>
																<p class="text-muted mb-0">Date</p>
																<input class="input--style-4 mb-3" value="" name="date" id="date-no-past" type="date" required>
																</center>
														</div>
														<div class="col-md-6 col-xs-6 col-sm-6">
																<center>
																<p class="text-muted mb-0">Time</p>
																<input class="input--style-4 mb-3" name="time" id="date-no-past" type="time" required>
																</center>
														</div>
														</div>
														<hr>
														<div id="records-dropdown">
															<a class="py-2 d-block h-100 w-100 position-relative z-index-1 pr-1 text-secondary"
															data-toggle="collapse" href="#symptoms" role="button">	
															<p class="text-danger font-weight-bold"><%= appointments.pre_diagnose_result %></p>
															<div class="position-relative">
																<small class="ml-1 font-weight-bold">Click to View Symptoms</small>
																<div class="position-absolute top-0 right-0 h-100 d-flex align-items-center">
																<i class="fa fa-plus"></i>
																</div>
															</div>
															</a>
															<div class="collapse" id="symptoms">
																<span id="symptoms-if-none"></span>
																<p id="exp-symptoms"><%= appointments.exp_symptoms %></p>
															</div>
														</div>
														<hr>
														<div class="d-flex justify-content-between mt-3">
														<% if(appointments.appointment_status == "Cancelled") {%> 
															<h6 class= "mt-3">Status: 
															<span class="text-warning font-weight-bold"><%= appointments.appointment_status %></span>
															</h6>
															<div>
																<h5 class="mb-0"><%= appointments.time %>
																</h5>
																<medium class="mb-0"><%= appointments.date %></medium>
															</div>
														<% }  else { %> 
															<h6 class= "mt-2">Status: 
															<span class="text-primary font-weight-bold"><%= appointments.appointment_status %></span>
															</h6>
															<input type="text" name="_id" value="<%= appointments._id %>" hidden>
															<input type="submit" class="button confirm-button" href="#!" id="confirm-date-time" aria-expanded="false" style="display: none ;" value="Approve Appointment">
														<% } %> 
														</div>
													</div>
												</form>
												</div>
											</div>
										</div>
										<% } else if (appointments.pre_diagnose_result == "Patient Has Infectious Symptoms" && appointments.appointment_status == "Approved" && staff.branch == appointments.branch) { %>
											<div class="searchhide yes">
												<div class="card p-3 mb-4">
													<div class="d-flex justify-content-between mb-4">
														<div class="user-info">
															<div class="user-info__img">
																<img src="uploads/<%= appointments.img_id %>.png" alt="User Img" onerror="this.onerror=null;this.src='files/male-avatar.png';">
															</div>
															<div class="user-info__basic">
																<h6 class="mb-0"><%= appointments.img_id %></h6>
																<h5 class="text-highlight mb-0"><%= appointments.first_name %> <%= appointments.last_name %></h5>
																<p class="text-muted mb-0" id="age<%= appointments._id %>"></p>
															</div>
														</div>
																
														<% if (appointments.appointment_status != "Cancelled") {%> 
															<div class="dropdown open">
																<a href="#!" class="px-2" id="b<%= appointments.id %>" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
																	<i class="fa fa-ellipsis-v"></i>
																</a>
																<div class="dropdown-menu dropdown-menu-right" aria-labelledby="<%= appointments.id %>">
													
																	<input type="button" class="dropdown-item text-primary" id="triggerId1"
																	data-toggle="modal" data-target="#a<%= appointments._id %><%= appointments.appointment_status %>" aria-haspopup="true"
																	aria-expanded="false" value="Set Appointment" onclick="editTimeDate()">

																	<form action="/cancel-appointment?_method=PUT" method="POST">
																		<input type="text" name="_id" value="<%= appointments._id %>" hidden>
																		<input class="dropdown-item text-danger" type="submit" value="Cancel">
																	</form>
																</div>
															</div>
															<% } else { %> 
																<div class="dropdown open">
																	<a href="#!" class="px-2" id="<%= appointments.id %>" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
																		<i class="fa fa-ellipsis-v"></i>
																	</a>
																	<div class="dropdown-menu dropdown-menu-right" aria-labelledby="<%= appointments.id %>">
																		<form action="/deactivate" method="POST">
																			<input type="text" name="_id" value="<%= appointments._id %>" hidden>
																			<input type="submit" class="dropdown-item text-danger" value="Remove">
																		</form>
																	</div>
																</div>
														<% } %> 
													</div>

													<div class="btn-records">
														<a class="button record-button" href="#!" id="triggerId1" data-toggle="modal"
														data-target="#a<%= appointments._id %><%= appointments.appointment_status %>"
														aria-haspopup="true" aria-expanded="false">View Appointment Info</a>
													</div>
													<hr>
													<div class="d-flex justify-content-between">
														<% if(appointments.appointment_status == "Cancelled") {%>
															<span class="text-warning font-weight-bold mt-3"><%= appointments.appointment_status %></span>
															<div>
																<h5 class="mb-0"><%= appointments.time %>
																</h5>
																<medium class="mt-0"><%= appointments.date %></medium>
															</div>
														<% }  else { %> 
															<span class="text-primary font-weight-bold"><%= appointments.appointment_status %></span>
														<% } %> 
													</div>
												</div>
											</div>
				
									<!-- ============================
											APPOINTMENT VIEW CARD
									============================== -->
				
									<div class="modal fade" id="a<%= appointments._id %><%= appointments.appointment_status %>" tabindex="-1" role="dialog">
										<div class="modal-dialog modal-dialog-centered" role="document">
										<div class="modal-content">
											<form action="/approve-appointment?_method=PUT" method="POST">
											<div class="p-4">
												<div class="d-flex justify-content-between mb-4">
													<div class="user-info">
														<div class="user-info__img">
																<img src="uploads/<%= appointments.img_id %>.png" alt="User Img" onerror="this.onerror=null;this.src='files/male-avatar.png';">
														</div>
														<div class="user-info__basic">
															<h6 class="mb-0"><%= appointments.img_id %></h6>
															<h5 class="text-highlight mb-0"><%= appointments.first_name %> <%= appointments.last_name %></h5>
															<p class="text-muted mb-0" id="age<%= appointments._id %>"></p>
														</div>
													</div>
													<% if (appointments.appointment_status != "Cancelled") {%> 
														<div class="dropdown open dropdown-set ">
															<a href="#!" class="px-2" id="b<%= appointments.id %>" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
																<i class="fa fa-ellipsis-v"></i>
															</a>
															<div class="dropdown-menu dropdown-menu-right" aria-labelledby="<%= appointments.id %>">

																<input type="button" class="dropdown-item text-primary"
																data-target="#a<%= appointments._id %><%= appointments.appointment_status %>"
																value="Set Appointment" onclick="editTimeDate()">

																<form action="/cancel-appointment?_method=PUT" method="POST">
																	<input type="text" name="_id" value="<%= appointments._id %>" hidden>
																	<input class="dropdown-item text-danger" type="submit" value="Cancel Appointment">
																</form>
															</div>
														</div>
														<% } else { %> 
															<div class="dropdown open">
																<a href="#!" class="px-2" id="<%= appointments.id %>" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
																	<i class="fa fa-ellipsis-v"></i>
																</a>
																<div class="dropdown-menu dropdown-menu-right" aria-labelledby="<%= appointments.id %>">
																	<form action="/deactivate" method="POST">
																		<input type="text" name="_id" value="<%= appointments._id %>" hidden>
																		<input type="submit" class="dropdown-item text-danger" value="Remove">
																	</form>
																</div>
															</div>
													<% } %> 
												</div>

													<p class="font-weight-bold text-info center"><%= appointments.service %></p>
													<hr>
													<div class="row">
														<div class="col-md-6 col-xs-6 col-sm-6">
																<center>
																<p class="text-muted mb-0 mt-2">Primary Phone</p>
																<h5 id="first_num"><%= appointments.phone %></h5>
																</center>
														</div>
														<div class="col-md-6 col-xs-6 col-sm-6">
																<center>
																<p class="text-muted mb-0 mt-2">Secondary Phone</p>
																<h5 id="second_num<%= appointments._id %>"><%= appointments.phone2 %></h5>
																</center>
																<script>
																	var second_num = document.getElementById("second_num<%= appointments._id %>").textContent;
																	if (second_num.length === 0 ) {
																	document.getElementById("second_num<%= appointments._id %>").innerHTML = "None";
																	}
																</script>
														</div>
													</div>
													<hr>
													<div class="row mb-4 mt-4">
														<div class="col-md-6 col-xs-6 col-sm-6">
															<center>
															<p class="text-muted mb-0">Date</p>
															<input class="input--style-4 mb-3" value="" name="date" id="date-no-past" type="date" required>
															</center>
													</div>
													<div class="col-md-6 col-xs-6 col-sm-6">
															<center>
															<p class="text-muted mb-0">Time</p>
															<input class="input--style-4 mb-3" name="time" id="date-no-past" type="time" required>
															</center>
													</div>
													</div>
													<hr>
													<div id="records-dropdown">
														<a class="py-2 d-block h-100 w-100 position-relative z-index-1 pr-1 text-secondary"
														data-toggle="collapse" href="#symptoms" role="button">	
														<p class="text-danger font-weight-bold"><%= appointments.pre_diagnose_result %></p>
														<div class="position-relative">
															<small class="ml-1 font-weight-bold">Click to View Symptoms</small>
															<div class="position-absolute top-0 right-0 h-100 d-flex align-items-center">
															<i class="fa fa-plus"></i>
															</div>
														</div>
														</a>
														<div class="collapse" id="symptoms">
															<span id="symptoms-if-none"></span>
															<p id="exp-symptoms"><%= appointments.exp_symptoms %></p>
														</div>
													</div>
													<hr>
													<div class="d-flex justify-content-between mt-3">
													<% if(appointments.appointment_status == "Cancelled") {%> 
														<h6 class= "mt-3">Status: 
														<span class="text-warning font-weight-bold"><%= appointments.appointment_status %></span>
														</h6>
														<div>
															<h5 class="mb-0"><%= appointments.time %>
															</h5>
															<medium class="mb-0"><%= appointments.date %></medium>
														</div>
													<% }  else { %> 
														<h6 class= "mt-2">Status: 
														<span class="text-primary font-weight-bold"><%= appointments.appointment_status %></span>
														</h6>
														<input type="text" name="_id" value="<%= appointments._id %>" hidden>
														<input type="submit" class="button confirm-button" href="#!" id="confirm-date-time" aria-expanded="false" style="display: none ;" value="Approve Appointment">
													<% } %> 
													</div>
												</div>
											</form>
											</div>
										</div>
									</div>
										<% } %>  
										<script>
											var now = Date.now();
											var bday = new Date("<%= appointments.birthday%>");
											var minus = now-bday
											var age = Math.floor(minus / 1000 / 60 / 60 / 24 / 365);
											document.getElementById("age<%= appointments._id %>").innerText = age + " yrs | <%= appointments.sex %>"
										</script>
										<% }); %> 
											
										</div>
									</section>
				

							</div>
							</div>
							</div>
					
					</section>
								
				</div>
						
			</section>
							<!-- END OF POSITIVE SECTION-->
					
				</div>
			</section>
			<% } %> 
		</main>
	<!-- NAVBAR -->
	
	<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

	<script src="assets/js/vendor/jquery/jquery.min.js"></script>
      <script src="assets/js/vendor/select2/select2.min.js"></script>
      <script src="assets/js/global.js"></script>
	  <script src="assets/js/script.js"></script>

	<!-- Patients JS -->

	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>

	<script>
		window.onload = function(){
			var el = document.getElementsByClassName('toggle-sidebar');
			for (var i=0;i<el.length; i++) {
			el[i].click();
		}
		
		}
		</script>

<script>
	$(document).ready(function(){
		$('#search').keyup(function(){
		
		// Search text
		var text = $(this).val();
		
		// Hide all content class element
		$('.searchhide').hide();

		// Search 
		$('.searchhide:contains("'+text+'")').closest('.searchhide').show();
		
		});
	});

	$.expr[":"].contains = $.expr.createPseudo(function(arg) {
		return function( elem ) {
		return $(elem).text().toUpperCase().indexOf(arg.toUpperCase()) >= 0;
		};
	});
</script>

<script>
function showToday() {
var checkBox = document.getElementById("showTodayOnly");

if (checkBox.checked == true){

var objToday = new Date(),
dayOfMonth = today + ( objToday.getDate() < 10) ? '0' + objToday.getDate() : objToday.getDate(),
months = new Array('January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'),
curMonth = months[objToday.getMonth()],
curYear = objToday.getFullYear();

var today = curMonth + " " + dayOfMonth + ", " + curYear;

// Hide all content class element
$('.searchhide').hide();

// Search 
$('.searchhide:contains("'+today+'")').closest('.searchhide').show();

} else {
$('.searchhide').show();

}
}
</script>

<script>
	$(document).ready(function(){
		
			
		$('.not:contains("Approved")').appendTo('#appointment-confirmed-not');
		$('.not:contains("Pending")').appendTo('#appointment-pending-not');
		$('.not:contains("Cancelled")').appendTo('#appointment-cancelled-not');
		$('.not:contains("Done")').appendTo('#appointment-done-not');
		
		$('.yes:contains("Approved")').appendTo('#appointment-confirmed-yes');
		$('.yes:contains("Pending")').appendTo('#appointment-pending-yes');
		$('.yes:contains("Cancelled")').appendTo('#appointment-cancelled-yes');
		$('.yes:contains("Done")').appendTo('#appointment-done-yes');


	});

	$.expr[":"].contains = $.expr.createPseudo(function(arg) {
		return function( elem ) {
		return $(elem).text().toUpperCase().indexOf(arg.toUpperCase()) >= 0;
		};
	});

</script>


<script>
	// in case of bootstrap modal example:
	$('.modal').on('shown.bs.modal', function () {
	  
	  var documentScrollTop = $(document).scrollTop();
	  $(document).on('scroll.noScroll', function() {
		 $(document).scrollTop(documentScrollTop);
		 return false;
	  });
	
	}).on('hidden.bs.modal', function() {
	
	  $(document).off('scroll.noScroll');
	
	});
</script>

<script>
	var today = new Date();
			var dd = String(today.getDate()).padStart(2, '0');
			var mm = String(today.getMonth() + 1).padStart(2, '0');
			var yyyy = today.getFullYear();
	
			today = yyyy + '-' + mm + '-' + dd;
			$('#date-no-past').attr('min',today);
	
</script>

<script>
	function editTimeDate() {
		
	$('.dropdown-set').hide();
	$('#confirm-date-time').show();
	$('.input--style-4').prop('disabled', false);
	$('.input--style-4').css({
        'background-color': '#ECECEC',
		'border': '1px solid black'
    });

	}

	function confirmTimeDate() {
	
	$('.dropdown-set').show();
	$('#confirm-date-time').hide();
	$('.input--style-4').prop('disabled', true);
	$('.input--style-4').css({
		"border": "1px solid #ced4da",
        'background-color': 'white',
    });
	}
	$('.input--style-4').prop('disabled', true);

</script>

<script>
	let str = document.getElementById("exp-symptoms").innerHTML; 
	let res = str.replace(/,/g, ", ");
	document.getElementById("exp-symptoms").innerHTML = res;
</script>


</body>
</html>